image:
  file: Dockerfile
ports:
  - port: 8080
    onOpen: open-browser
  - port: 3306
    onOpen: ignore
checkoutLocation: "wordpress"
workspaceLocation: "."
tasks:
  - name: Apache & MySQL
    command: >
        mysqld --initialize-insecure;
        mysqld &
        sleep 5;
        mysql -u root -e "CREATE DATABASE wordpress";
        cd $GITPOD_REPO_ROOT;
        apachectl start;
  - name: Wordpress
    init: wp core download --path=$GITPOD_REPO_ROOT;
    command: >
        wp core config --dbname=wordpress --dbuser=root --dbpass=root --extra-php <<PHP define( 'WP_DEBUG', true ); define( 'DISALLOW_FILE_EDIT', true ); PHP
        wp core install --url=$(gp url 8080) --title="Gymnasium's WP-Gitpod" --admin_user=gym --admin_password=gym --admin_email=admin@email.com;
        curl http://loripsum.net/api/3 | wp post generate --post_content --count=10;
        chmod 777 $GITPOD_REPO_ROOT/.htaccess;
        cd $GITPOD_REPO_ROOT;
